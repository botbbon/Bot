{
  "version": "1.0",
  "generatedAt": "2025-08-28T00:00:00Z",
  "note": "Per-protocol detection rules to guide Helius WS and polling listeners. Unknown mappings left as 'unknown' and treated with generic AMM rules.",
  "protocols": [
    {
      "name": "spl-token",
      "pubkey": "TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",
      "type": "core",
      "detection": {
        "logsKeywords": ["initializemint", "mintto", "initializeaccount", "create account"],
        "parsedInstructionTypes": ["initializeMint", "mintTo", "initializeAccount"],
        "requirePostTokenBalances": true,
        "confidence": "high"
      },
      "notes": "SPL token program — treat initializeMint/mintTo on this program as canonical token creation. Use pre/post token balances to find mints."
    },
    {
      "name": "metaplex-token-metadata",
      "pubkey": "metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s",
      "type": "metadata",
      "detection": {
        "logsKeywords": ["create metadata", "update metadata", "mint edition"],
        "parsedInstructionTypes": ["createMetadataAccountV2", "createMetadataAccount"],
        "requirePostTokenBalances": false,
        "confidence": "medium"
      },
      "notes": "Metadata program often accompanies token mints; useful as corroborating evidence (not standalone)."
    },
    {
      "name": "memo",
      "pubkey": "MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr",
      "type": "utility",
      "detection": {
        "logsKeywords": ["memo"],
        "parsedInstructionTypes": ["memo"],
        "requirePostTokenBalances": true,
        "confidence": "low"
      },
      "notes": "Memos are noisy. Accept memo-only events only when postTokenBalances or inner-instruction token activity corroborates."
    },
    {
      "name": "system",
      "pubkey": "11111111111111111111111111111111",
      "type": "system",
      "detection": {
        "logsKeywords": ["create account", "transfer"],
        "parsedInstructionTypes": ["createAccount", "transfer"],
        "requirePostTokenBalances": false,
        "confidence": "none"
      },
      "notes": "System program is not a token; ignore as mint candidate."
    },
    {
      "name": "raydium-like",
      "pubkey": "9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin",
      "type": "amm",
      "detection": {
        "logsKeywords": ["swap", "swap instruction", "add_liquidity", "addliquidity", "amm"],
        "parsedInstructionTypes": ["swap", "addLiquidity", "initializePool", "createPool"],
        "programIdMatch": true,
        "requireInnerTokenTransfers": true,
        "confidence": "high"
      },
      "notes": "AMM-style protocols usually emit swap/addliquidity instructions via their program id. Match parsed.programId or parsed.program strings. Require inner token transfers or postTokenBalances to reduce false positives."
    },
    {
      "name": "orca-like",
      "pubkey": "whirLbMiicVdio4qvUfM5KAg6Ct8VwpYzGff3uctyCc",
      "type": "amm",
      "detection": {
        "logsKeywords": ["swap", "add_liquidity", "swap_exact", "swap_exact_in"],
        "parsedInstructionTypes": ["swap", "addLiquidity"],
        "programIdMatch": true,
        "requireInnerTokenTransfers": true,
        "confidence": "high"
      },
      "notes": "Treat these as standard AMM pools — parsed instruction.programId should match this pubkey in many swap operations."
    },
    {
      "name": "pammpool-like",
      "pubkey": "pAMMBay6oceH9fJKBRHGP5D4bD4sWpmSwMn52FMfXEA",
      "type": "amm",
      "detection": {
        "logsKeywords": ["swap", "deposit", "withdraw", "addliquidity"],
        "parsedInstructionTypes": ["swap", "deposit", "withdraw", "addLiquidity"],
        "programIdMatch": true,
        "requireInnerTokenTransfers": true,
        "confidence": "medium"
      },
      "notes": "Less common AMM program — use generic AMM rules and require token-transfer corroboration."
    },
    {
      "name": "jupiter-router",
      "pubkey": "JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4",
      "type": "router",
      "detection": {
        "logsKeywords": ["swap", "route", "jupiter"],
        "parsedInstructionTypes": ["swap", "multiSwap", "route"],
        "programIdMatch": true,
        "requireInnerTokenTransfers": true,
        "confidence": "medium"
      },
      "notes": "Jupiter is a router/aggregator and will appear in swap paths; use as corroboration for swaps but not for pool creation detection."
    },
    {
      "name": "camms-like",
      "pubkey": "CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK",
      "type": "amm",
      "detection": {
        "logsKeywords": ["swap", "liquidity", "amm"],
        "parsedInstructionTypes": ["swap", "addLiquidity", "removeLiquidity"],
        "programIdMatch": true,
        "requireInnerTokenTransfers": true,
        "confidence": "medium"
      },
      "notes": "Generic AMM detection rules apply."
    },
    {
      "name": "unknown-9H6tua...",
      "pubkey": "9H6tua7jkLhdm3w8BvgpTn5LZNU7g4ZynDmCiNN3q6Rp",
      "type": "unknown",
      "detection": {
        "logsKeywords": ["swap", "addliquidity", "initialize"],
        "parsedInstructionTypes": ["swap", "addLiquidity", "initialize"],
        "programIdMatch": true,
        "requireInnerTokenTransfers": true,
        "confidence": "unknown"
      },
      "notes": "Protocol mapping not verified. Apply generic AMM rules and collect example transactions for manual mapping later."
    },
    {
      "name": "perp-like",
      "pubkey": "PERPHjGBqRHArX4DySjwM6UJHiR3sWAatqfdBS2qQJu",
      "type": "amm_or_perp",
      "detection": {
        "logsKeywords": ["openposition", "swap", "liquidity", "perp"],
        "parsedInstructionTypes": ["swap", "openPosition", "addLiquidity"],
        "programIdMatch": true,
        "requireInnerTokenTransfers": false,
        "confidence": "unknown"
      },
      "notes": "May represent a perpetual or specialized AMM program. Treat conservatively; require additional corroboration before accepting new mints based solely on this program."
    }
  ]
}
